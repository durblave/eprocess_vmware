---
- name: ping windows host
  hosts: all
  gather_facts: false
  become: false

  tasks:
    - name: ping host
      ansible.windows.win_ping:

    # - name: Gather list
    #   win_shell: Get-ItemProperty HKLM:\Software\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall* | Select-Object DisplayName, DisplayVersion, Publisher, InstallDate | Format-Table â€“AutoSize
    #   register: program_list

    # - debug:
    #   msg: "{{ program_list.stdout.split('\n') }}"

    - name: Gather list
      win_shell: Get-Service | Sort-Object Status -Descending
      register: service_list

    - debug:
        msg: "{{ service_list.stdout.split('\n') }}"  

      # Install and enable IIS on Windows server 2019
    - name: Install IIS
      win_feature:
        name: "Web-Server"
        state: present
        restart: yes
        include_sub_features: yes
        include_management_tools: yes      

    - name: Start IIS Service
      win_service:
        name: W3Svc
        state: started
        start_mode: auto

    - name: Start IIS Service
      win_service:
        name: W3Svc
        state: restarted
        start_mode: auto        

    - name: Start IIS Service
      win_service:
        name: W3Svc
        state: stopped
        start_mode: auto      

####### Install and configure SNMP functionality on Windows with Ansible
---
 - name: SNMP conf for Windows
   hosts: windows # host group to run the module on
   tasks:
   -  name: Install Service
      ansible.windows.win_feature:
        name: SNMP-Service
        include_management_tools: yes
        state: present

   -  name: Replace SNMP
      community.windows.win_snmp:
        community_strings:
        - RDRIT
        permitted_managers:
        - 192.168.100.100
        action: set


################ Install Windows Updates with an Ansible Playbook
---
- name: Windows Update
  hosts: windows
  tasks:
    - name: Install all update
      ansible.windows.win_updates:
        category_names:
          - SecurityUpdates
          - CriticalUpdates
          - Update Rollups
          - Updates
          - Application
          - Definition Updates
        log_path: C:\ansible_wu.txt                 

################ COnfigure DNS Client
        
---
- name: "DNS Client"
  hosts: windows
  tasks:
    - name: "Set DNS Client"
      win_dns_client:
          adapter_names: Ethernet
          ipv4_addresses:
          - 192.168.0.10
          - 8.8.8.8



ECOBANK.GROUP = {
}

[domain_realm]
# .example.com = EXAMPLE.COM
# example.com = EXAMPLE.COM
ecobank.group = ECOBANK.GROUP
.ecobank.group = ECOBANK.GROUP

[5:34 PM] AMEWUDA Andy Bubune [EPI-Technology Ops]
# Configuration snippets may be placed in this directory as well
includedir /etc/krb5.conf.d/

includedir /var/lib/sss/pubconf/krb5.include.d/
[logging]
default = FILE:/var/log/krb5libs.log
kdc = FILE:/var/log/krb5kdc.log
admin_server = FILE:/var/log/kadmind.log

[libdefaults]
dns_lookup_realm = false
ticket_lifetime = 24h
renew_lifetime = 7d
forwardable = true
rdns = false
# default_realm = EXAMPLE.COM
default_ccache_name = KEYRING:persistent:%{uid}

 default_realm = ECOBANK.GROUP
default_keytab_name = /etc/krb5.keytab
[realms]
# EXAMPLE.COM = {#  kdc = kerberos.example.com#  admin_server = kerberos.example.com
# }

 ECOBANK.GROUP = {
}

[domain_realm]
# .example.com = EXAMPLE.COM
# example.com = EXAMPLE.COM
ecobank.group = ECOBANK.GROUP
.ecobank.group = ECOBANK.GROUP

